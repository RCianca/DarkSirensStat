from globals import H0GLOB, Xi0Glob

####################################
# Set here the parameters of the run 
####################################


# --------------------------------------------------------------
# INFERENCE SETUP
# --------------------------------------------------------------
do_inference=True

## Variable for the inference:  H0 or Xi0
goalParam = 'H0'

## Output folder name
#fout = 'ET_newsigma'
fout = 'newruns31_with_uniform_autoconsistent_11'

#only to some  test, then remove 
delta=1#(0.318639,0.674490,0.977925,0.994458,1.281552,1.644854,1.959964,2)
forcePcopl=1
rate=0
## Specify the exponent of the redshift distribution , p(z) = dV/dz* (1+z)^(lamb-1)
lamb=1
EM=0
#mock BNS dl
#68 54 40 20 170817
myredshift=0.003692 #0.0155368 #0.0120821 #0.00862733 #0.003692 #0.0098 
mysigz= 0.3528418527151356 #0.0010199 #0.000851667 #0.000694791 #0.000511387 #0.0004 #testconst=0.3528418527151356
## Prior limits
Xi0min =  Xi0Glob # 0.3 
Xi0max =  Xi0Glob # 10
H0min =   30 # H0GLOB
H0max =    130


## Number of points for posterior grid
nPointsPosterior = 1000

verbose=True

# --------------------------------------------------------------
# GW DATA OPTIONS
# --------------------------------------------------------------


## Select dataset : O2, O3
observingRun = 'O3'

## Select BBH or BNS
eventType='BBH'

detector='ET'
#detector='vanilla'

print(detector)

## Specify which mass distribution to use. Options: O2, O3, NS-flat, NS-gauss
massDist='O3'


## Specify parameters of the broken power law model
#Raul: Using new parameter, to recover look at config original ora at some old runs
gamma1=1.5
gamma2=5.0
betaq=0.28
mMin=5
mMax=80
deltam=0.39

# Only one between mBreak and b should be given
b=None
mBreak=40


# How to select credible region in redshift, 'skymap' or 'header'
zLimSelection='skymap'

## Names of events to analyse. If None, all events in the folder will be used
#subset_names = ['GW221501'] #['GW190924_021846'] #['GW190924_021846'] #['GW190425',] #['GW190814']
#------------------------Pre-selected-runs----------------------------------
#---------------------------------GW30xxxx-------------------------------------------------
#subset_names=['GW300000','GW300001','GW300002','GW300003','GW300004','GW300005','GW300006','GW300007','GW300008','GW300009','GW300010','GW300011','GW300012','GW300013','GW300014','GW300015','GW300016','GW300017','GW300018','GW300019','GW300020','GW300021','GW300022','GW300023','GW300024','GW300025','GW300026','GW300027','GW300028','GW300029']#00
#subset_names=['GW300030','GW300031','GW300032','GW300033','GW300034','GW300035','GW300036','GW300037','GW300038','GW300039','GW300040','GW300041','GW300042','GW300043','GW300044','GW300045','GW300046','GW300047','GW300048','GW300049','GW300050','GW300051','GW300052','GW300053','GW300054','GW300055','GW300056','GW300057','GW300058']#01
#subset_names=['GW300059','GW300060','GW300061','GW300062','GW300063','GW300064','GW300065','GW300066','GW300067','GW300068','GW300069','GW300070','GW300071','GW300072','GW300073','GW300074','GW300075','GW300076','GW300077','GW300078','GW300079','GW300080','GW300081','GW300082','GW300083','GW300084','GW300085','GW300086','GW300087']#02
#subset_names=['GW300088','GW300089','GW300090','GW300091','GW300092','GW300093','GW300094','GW300095','GW300096','GW300097','GW300098','GW300099','GW300100','GW300101','GW300102','GW300103','GW300104','GW300105','GW300106','GW300107','GW300108','GW300109','GW300110','GW300111','GW300112','GW300113','GW300114','GW300115','GW300116']#03
#subset_names=['GW300117','GW300118','GW300119','GW300120','GW300121','GW300122','GW300123','GW300124','GW300125','GW300126','GW300127','GW300128','GW300129','GW300130','GW300131','GW300132','GW300133','GW300134','GW300135','GW300136','GW300137','GW300138','GW300139','GW300140','GW300141','GW300142','GW300143','GW300144','GW300145']#04
#subset_names=['GW300146','GW300147','GW300148','GW300149','GW300150','GW300151','GW300152','GW300153','GW300154','GW300155','GW300156','GW300157','GW300158','GW300159','GW300160','GW300161','GW300162','GW300163','GW300164','GW300165','GW300166','GW300167','GW300168','GW300169','GW300170','GW300171','GW300172','GW300173','GW300174']#05
#subset_names=['GW300175','GW300176','GW300177','GW300178','GW300179','GW300180','GW300181','GW300182','GW300183','GW300184','GW300185','GW300186','GW300187','GW300188','GW300189','GW300190','GW300191','GW300192','GW300193','GW300194','GW300195','GW300196','GW300197','GW300198','GW300199','GW300200','GW300201','GW300202','GW300203']#06
#subset_names=['GW300204','GW300205','GW300206','GW300207','GW300208','GW300209','GW300210','GW300211','GW300212','GW300213','GW300214','GW300215','GW300216','GW300217','GW300218','GW300219','GW300220','GW300221','GW300222','GW300223','GW300224','GW300225','GW300226','GW300227','GW300228','GW300229','GW300230','GW300231','GW300232']#07
#subset_names=['GW300233','GW300234','GW300235','GW300236','GW300237','GW300238','GW300239','GW300240','GW300241','GW300242','GW300243','GW300244','GW300245','GW300246','GW300247','GW300248','GW300249','GW300250','GW300251','GW300252','GW300253','GW300254','GW300255','GW300256','GW300257','GW300258','GW300259','GW300260','GW300261']#08
#subset_names=['GW300262','GW300263','GW300264','GW300265','GW300266','GW300267','GW300268','GW300269','GW300270','GW300271','GW300272','GW300273','GW300274','GW300275','GW300276','GW300277','GW300278','GW300279','GW300280','GW300281','GW300282','GW300283','GW300284','GW300285','GW300286','GW300287','GW300288','GW300289','GW300290']#09
#subset_names=['GW300291','GW300292','GW300293','GW300294','GW300295','GW300296','GW300297','GW300298','GW300299','GW300300','GW300301','GW300302','GW300303','GW300304','GW300305','GW300306','GW300307','GW300308','GW300309','GW300310','GW300311','GW300312','GW300313','GW300314','GW300315','GW300316','GW300317','GW300318','GW300319']#10
#subset_names=['GW300320','GW300321','GW300322','GW300323','GW300324','GW300325','GW300326','GW300327','GW300328','GW300329','GW300330','GW300331','GW300332','GW300333','GW300334','GW300335','GW300336','GW300337','GW300338','GW300339','GW300340','GW300341']#11
#--------------------------------------GW31xxxx-------------------------------------------
#subset_names=['GW310000','GW310001','GW310002','GW310003','GW310004','GW310005','GW310006','GW310007','GW310008','GW310009','GW310010','GW310011','GW310012','GW310013','GW310014','GW310015','GW310016','GW310017','GW310018','GW310019','GW310020','GW310021','GW310022','GW310023','GW310024','GW310025','GW310026','GW310027','GW310028','GW310029']#00
#subset_names=['GW310030','GW310031','GW310032','GW310033','GW310034','GW310035','GW310036','GW310037','GW310038','GW310039','GW310040','GW310041','GW310042','GW310043','GW310044','GW310045','GW310046','GW310047','GW310048','GW310049','GW310050','GW310051','GW310052','GW310053','GW310054','GW310055','GW310056','GW310057','GW310058']#01
#subset_names=['GW310059','GW310060','GW310061','GW310062','GW310063','GW310064','GW310065','GW310066','GW310067','GW310068','GW310069','GW310070','GW310071','GW310072','GW310073','GW310074','GW310075','GW310076','GW310077','GW310078','GW310079','GW310080','GW310081','GW310082','GW310083','GW310084','GW310085','GW310086','GW310087']#02
#subset_names=['GW310088','GW310089','GW310090','GW310091','GW310092','GW310093','GW310094','GW310095','GW310096','GW310097','GW310098','GW310099','GW310100','GW310101','GW310102','GW310103','GW310104','GW310105','GW310106','GW310107','GW310108','GW310109','GW310110','GW310111','GW310112','GW310113','GW310114','GW310115','GW310116']#03
#subset_names=['GW310117','GW310118','GW310119','GW310120','GW310121','GW310122','GW310123','GW310124','GW310125','GW310126','GW310127','GW310128','GW310129','GW310130','GW310131','GW310132','GW310133','GW310134','GW310135','GW310136','GW310137','GW310138','GW310139','GW310140','GW310141','GW310142','GW310143','GW310144','GW310145']#04
#subset_names=['GW310146','GW310147','GW310148','GW310149','GW310150','GW310151','GW310152','GW310153','GW310154','GW310155','GW310156','GW310157','GW310158','GW310159','GW310160','GW310161','GW310162','GW310163','GW310164','GW310165','GW310166','GW310167','GW310168','GW310169','GW310170','GW310171','GW310172','GW310173','GW310174']#05
#subset_names=['GW310175','GW310176','GW310177','GW310178','GW310179','GW310180','GW310181','GW310182','GW310183','GW310184','GW310185','GW310186','GW310187','GW310188','GW310189','GW310190','GW310191','GW310192','GW310193','GW310194','GW310195','GW310196','GW310197','GW310198','GW310199','GW310200','GW310201','GW310202','GW310203']#06
#subset_names=['GW310204','GW310205','GW310206','GW310207','GW310208','GW310209','GW310210','GW310211','GW310212','GW310213','GW310214','GW310215','GW310216','GW310217','GW310218','GW310219','GW310220','GW310221','GW310222','GW310223','GW310224','GW310225','GW310226','GW310227','GW310228','GW310229','GW310230','GW310231','GW310232']#07
#subset_names=['GW310233','GW310234','GW310235','GW310236','GW310237','GW310238','GW310239','GW310240','GW310241','GW310242','GW310243','GW310244','GW310245','GW310246','GW310247','GW310248','GW310249','GW310250','GW310251','GW310252','GW310253','GW310254','GW310255','GW310256','GW310257','GW310258','GW310259','GW310260','GW310261']#08
#subset_names=['GW310262','GW310263','GW310264','GW310265','GW310266','GW310267','GW310268','GW310269','GW310270','GW310271','GW310272','GW310273','GW310274','GW310275','GW310276','GW310277','GW310278','GW310279','GW310280','GW310281','GW310282','GW310283','GW310284','GW310285','GW310286','GW310287','GW310288','GW310289','GW310290']#09
#subset_names=['GW310291','GW310292','GW310293','GW310294','GW310295','GW310296','GW310297','GW310298','GW310299','GW310300','GW310301','GW310302','GW310303','GW310304','GW310305','GW310306','GW310307','GW310308','GW310309','GW310310','GW310311','GW310312','GW310313','GW310314','GW310315','GW310316','GW310317','GW310318','GW310319']#10
subset_names=['GW310320','GW310321','GW310322','GW310323','GW310324','GW310325','GW310326','GW310327','GW310328','GW310329','GW310330','GW310331','GW310332','GW310333','GW310334','GW310335','GW310336','GW310337','GW310338','GW310339','GW310340','GW310341']#11
#-----------------------------------------------------------------------------------------

#--------------------------------------GW32xxxx-------------------------------------------
#subset_names=['GW320000','GW320001','GW320002','GW320003','GW320004','GW320005','GW320006','GW320007','GW320008','GW320009','GW320010','GW320011','GW320012','GW320013','GW320014','GW320015','GW320016','GW320017','GW320018','GW320019','GW320020','GW320021','GW320022','GW320023','GW320024','GW320025','GW320026','GW320027','GW320028','GW320029']#00
#subset_names=['GW320030','GW320031','GW320032','GW320033','GW320034','GW320035','GW320036','GW320037','GW320038','GW320039','GW320040','GW320041','GW320042','GW320043','GW320044','GW320045','GW320046','GW320047','GW320048','GW320049','GW320050','GW320051','GW320052','GW320053','GW320054','GW320055','GW320056','GW320057','GW320058']#01
#subset_names=['GW320059','GW320060','GW320061','GW320062','GW320063','GW320064','GW320065','GW320066','GW320067','GW320068','GW320069','GW320070','GW320071','GW320072','GW320073','GW320074','GW320075','GW320076','GW320077','GW320078','GW320079','GW320080','GW320081','GW320082','GW320083','GW320084','GW320085','GW320086','GW320087']#02
#subset_names=['GW320088','GW320089','GW320090','GW320091','GW320092','GW320093','GW320094','GW320095','GW320096','GW320097','GW320098','GW320099','GW320100','GW320101','GW320102','GW320103','GW320104','GW320105','GW320106','GW320107','GW320108','GW320109','GW320110','GW320111','GW320112','GW320113','GW320114','GW320115','GW320116']#03
#subset_names=['GW320117','GW320118','GW320119','GW320120','GW320121','GW320122','GW320123','GW320124','GW320125','GW320126','GW320127','GW320128','GW320129','GW320130','GW320131','GW320132','GW320133','GW320134','GW320135','GW320136','GW320137','GW320138','GW320139','GW320140','GW320141','GW320142','GW320143','GW320144','GW320145']#04
#subset_names=['GW320146','GW320147','GW320148','GW320149','GW320150','GW320151','GW320152','GW320153','GW320154','GW320155','GW320156','GW320157','GW320158','GW320159','GW320160','GW320161','GW320162','GW320163','GW320164','GW320165','GW320166','GW320167','GW320168','GW320169','GW320170','GW320171','GW320172','GW320173','GW320174']#05
#subset_names=['GW320175','GW320176','GW320177','GW320178','GW320179','GW320180','GW320181','GW320182','GW320183','GW320184','GW320185','GW320186','GW320187','GW320188','GW320189','GW320190','GW320191','GW320192','GW320193','GW320194','GW320195','GW320196','GW320197','GW320198','GW320199','GW320200','GW320201','GW320202','GW320203']#06
#subset_names=['GW320204','GW320205','GW320206','GW320207','GW320208','GW320209','GW320210','GW320211','GW320212','GW320213','GW320214','GW320215','GW320216','GW320217','GW320218','GW320219','GW320220','GW320221','GW320222','GW320223','GW320224','GW320225','GW320226','GW320227','GW320228','GW320229','GW320230','GW320231','GW320232']#07
#subset_names=['GW320233','GW320234','GW320235','GW320236','GW320237','GW320238','GW320239','GW320240','GW320241','GW320242','GW320243','GW320244','GW320245','GW320246','GW320247','GW320248','GW320249','GW320250','GW320251','GW320252','GW320253','GW320254','GW320255','GW320256','GW320257','GW320258','GW320259','GW320260','GW320261']#08
#subset_names=['GW320262','GW320263','GW320264','GW320265','GW320266','GW320267','GW320268','GW320269','GW320270','GW320271','GW320272','GW320273','GW320274','GW320275','GW320276','GW320277','GW320278','GW320279','GW320280','GW320281','GW320282','GW320283','GW320284','GW320285','GW320286','GW320287','GW320288','GW320289','GW320290']#09
#subset_names=['GW320291','GW320292','GW320293','GW320294','GW320295','GW320296','GW320297','GW320298','GW320299','GW320300','GW320301','GW320302','GW320303','GW320304','GW320305','GW320306','GW320307','GW320308','GW320309','GW320310','GW320311','GW320312','GW320313','GW320314','GW320315','GW320316','GW320317','GW320318','GW320319']#10
#subset_names=['GW320320','GW320321','GW320322','GW320323','GW320324','GW320325','GW320326','GW320327','GW320328','GW320329','GW320330','GW320331','GW320332','GW320333','GW320334','GW320335','GW320336','GW320337','GW320338','GW320339','GW320340','GW320341']#11
#-----------------------------------------------------------------------------------------
#--------------------------------------GW33xxxx-------------------------------------------
#subset_names=['GW330000','GW330001','GW330002','GW330003','GW330004','GW330005','GW330006','GW330007','GW330008','GW330009','GW330010','GW330011','GW330012','GW330013','GW330014','GW330015','GW330016','GW330017','GW330018','GW330019','GW330020','GW330021','GW330022','GW330023','GW330024','GW330025','GW330026','GW330027','GW330028','GW330029']#00
#subset_names=['GW330030','GW330031','GW330032','GW330033','GW330034','GW330035','GW330036','GW330037','GW330038','GW330039','GW330040','GW330041','GW330042','GW330043','GW330044','GW330045','GW330046','GW330047','GW330048','GW330049','GW330050','GW330051','GW330052','GW330053','GW330054','GW330055','GW330056','GW330057','GW330058']#01
#subset_names=['GW330059','GW330060','GW330061','GW330062','GW330063','GW330064','GW330065','GW330066','GW330067','GW330068','GW330069','GW330070','GW330071','GW330072','GW330073','GW330074','GW330075','GW330076','GW330077','GW330078','GW330079','GW330080','GW330081','GW330082','GW330083','GW330084','GW330085','GW330086','GW330087']#02
#subset_names=['GW330088','GW330089','GW330090','GW330091','GW330092','GW330093','GW330094','GW330095','GW330096','GW330097','GW330098','GW330099','GW330100','GW330101','GW330102','GW330103','GW330104','GW330105','GW330106','GW330107','GW330108','GW330109','GW330110','GW330111','GW330112','GW330113','GW330114','GW330115','GW330116']#03
#subset_names=['GW330117','GW330118','GW330119','GW330120','GW330121','GW330122','GW330123','GW330124','GW330125','GW330126','GW330127','GW330128','GW330129','GW330130','GW330131','GW330132','GW330133','GW330134','GW330135','GW330136','GW330137','GW330138','GW330139','GW330140','GW330141','GW330142','GW330143','GW330144','GW330145']#04
#subset_names=['GW330146','GW330147','GW330148','GW330149','GW330150','GW330151','GW330152','GW330153','GW330154','GW330155','GW330156','GW330157','GW330158','GW330159','GW330160','GW330161','GW330162','GW330163','GW330164','GW330165','GW330166','GW330167','GW330168','GW330169','GW330170','GW330171','GW330172','GW330173','GW330174']#05
#subset_names=['GW330175','GW330176','GW330177','GW330178','GW330179','GW330180','GW330181','GW330182','GW330183','GW330184','GW330185','GW330186','GW330187','GW330188','GW330189','GW330190','GW330191','GW330192','GW330193','GW330194','GW330195','GW330196','GW330197','GW330198','GW330199','GW330200','GW330201','GW330202','GW330203']#06
#subset_names=['GW330204','GW330205','GW330206','GW330207','GW330208','GW330209','GW330210','GW330211','GW330212','GW330213','GW330214','GW330215','GW330216','GW330217','GW330218','GW330219','GW330220','GW330221','GW330222','GW330223','GW330224','GW330225','GW330226','GW330227','GW330228','GW330229','GW330230','GW330231','GW330232']#07
#subset_names=['GW330233','GW330234','GW330235','GW330236','GW330237','GW330238','GW330239','GW330240','GW330241','GW330242','GW330243','GW330244','GW330245','GW330246','GW330247','GW330248','GW330249','GW330250','GW330251','GW330252','GW330253','GW330254','GW330255','GW330256','GW330257','GW330258','GW330259','GW330260','GW330261']#08
#subset_names=['GW330262','GW330263','GW330264','GW330265','GW330266','GW330267','GW330268','GW330269','GW330270','GW330271','GW330272','GW330273','GW330274','GW330275','GW330276','GW330277','GW330278','GW330279','GW330280','GW330281','GW330282','GW330283','GW330284','GW330285','GW330286','GW330287','GW330288','GW330289','GW330290']#09
#subset_names=['GW330291','GW330292','GW330293','GW330294','GW330295','GW330296','GW330297','GW330298','GW330299','GW330300','GW330301','GW330302','GW330303','GW330304','GW330305','GW330306','GW330307','GW330308','GW330309','GW330310','GW330311','GW330312','GW330313','GW330314','GW330315','GW330316','GW330317','GW330318','GW330319']#10
#subset_names=['GW330320','GW330321','GW330322','GW330323','GW330324','GW330325','GW330326','GW330327','GW330328','GW330329','GW330330','GW330331','GW330332','GW330333','GW330334','GW330335','GW330336','GW330337','GW330338','GW330339','GW330340','GW330341']#11
#-----------------------------------------------------------------------------------------

#------------------------------------------------------------------------------------------


## Select events based on completeness at the nominal position
select_events=True

## Threshold in probability at position of the event, for event selection
completnessThreshCentral=0.7



## Confidence region for GW skymaps
level = 0.99
std_number=5 #if none, it is computed from level


# --------------------------------------------------------------
# GALAXY CATALOGUE OPTIONS
# --------------------------------------------------------------

## Galaxy catalogue
catalogue='GLADE'

# Check if events fall in DES or GWENS footprint
do_check_footprint=False


## Luminosity cut and band. 
# Band should be None if we use number counts
Lcut=0.6
# Band for lum cut
band= 'K' # B, K, or None . 
# Average galaxy density in comoving volume, used if band='None'. A number, or 'auto' (only for mask completeness) 
Nbar = 'auto'
# Band for lum weights
band_weight = None  # B, K, or None . 



## Use of galaxy redshift errors
galRedshiftErrors = False

## Use of galaxy posteriors, i.e. convolve the likelihood in redshift with a prior p(z) = dV_c/dz
galPosterior = False


# --------------------------------------------------------------
# COMPLETENESS AND COMPLETION OPTIONS
# --------------------------------------------------------------

## Completeness. 'load', 'pixel' main mi corregge con pix, 'mask', 'skip'
completeness = 'mask'
# path of completeness file if completeness='load' and using GLADE
completeness_path = 'hpx_B_zmin0p01_zmax0p25_nside32_npoints25.txt'
# Options for SuperPixelCompleteness
angularRes, interpolateOmega = 4, False
zRes = 30
# nMasks for mask completeness. 2 for DES/GWENS, >5 for GLADE
nMasks = 9
#
plot_comp=False


## Type of completion: 'mult' , 'add' or 'mix' 
completionType = 'mix'
# Use MC integration or not in the computation of additive completion
MChom=True
# N. of homogeneous MC samples
nHomSamples=15000



# --------------------------------------------------------------
# BETA OPTIONS
# --------------------------------------------------------------

## Which beta to use. 'fit', 'MC', 'hom', 'cat'
which_beta = 'hom'

# only used when which_beta='hom'. If 'scale', use individually SNR rescaled dmax estimate. If 'flat' use d of event. If a number use that for all events. 
betaHomdMax =15978.6 #600 roughly O3, for ET use this now or 15000 or 15978.6
#betaHomMax = 425.7 # O2 


# Max redshift  of the region R,  if beta is 'fit'
zR = 20
# n of MC samples for beta MC
nSamplesBetaMC= 250000
nUseCatalogBetaMC = True
SNRthresh=100

# Use SNR at all orders or 1st order approximation.
# SNR at all orders is computed from a pre-computed grid
fullSNR=True
